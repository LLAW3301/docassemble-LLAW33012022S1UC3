# Code block that sets DAFileList
---
objects:
  - AAT_documents: DAFileList(there_are_any = False)
---
# Question block for uploading/downloading letter of consent
question: Upload Letter of Consent 
subquestion:  |
  Please upload a completed **Letter of Consent to Share Information**. PDF and image files accepted. 
  
   If you do not have a copy of this form, you can download a blank copy [here](${ url_of('Consent_to_share.pdf')}) 
fields:
  - Upload: letter_of_consent
    datatype: file
    accept: |
      "image/*, .pdf, application/pdf"
    required: False
---
# Question block for uploading/downloading new access request
question: Upload New Access Request
subquestion:  |
  Please upload a completed **Access Request**. PDF and image files accepted. 
  
   If you do not have a copy of this form, you can download a blank copy [here](${ url_of('Access_Request_Form.pdf')}) 
fields:
  - Upload: new_access_request
    datatype: file
    accept: |
      "image/*, .pdf, application/pdf"
    required: False
---
# Question block for internal review details
# Includes legislation
question: Internal Review Details
fields:
  - What date did you receive your decision?: date_recieved_access_request 
    datatype: date
    help: This date must be no more than 90 days from today.
    #required: False
  #- Have you received an extension for your Internal Review Application?: internal_review_extension
    #show if: 
      #code: extension_needed
      #variable: extension_needed
      #is: True
  - Is the date entered above the Original Review Decision Date?: confirm_date_internal_review_decision
    help: 
      Yes indicates the above date as your Original Review Decision,
      No indicates above date is the last approved extension date you had been granted for internal review application)
    datatype: radio
    choices:
      -  Yes
      -  No
  - What was the original date for Internal Review Decision, if the date above is the maximum allowed internal review date from your approved extension request: original_date_recieved_access_request
    datatype: date
    max: ${ today() }
    show if: 
      variable: confirm_date_internal_review_decision
      is: No
  - What date did you receive funding for your plan: date_recieved_funding 
    datatype: date
    required: False
  - What was the reason for rejection?: rejection_reason_access_request
    input type: area
    required: False
  - Please upload a copy of the decision: copy_of_internal_review_decision
    datatype: file
    accept: |
      "image/*, .pdf, application/pdf"
    required: False
under: | 
  Section 100 of the NDIS Act enstablishes that the decision-maker of a reviewable decision must give written notice of the reviewable decision, and of the reasons for the reviewable decision, to each person directly affected by the reviewable decision.
  
  Section 34 of the NDIS Act establishes the criteria for what supports are considered "reasonable and necessary" for the NDIS to cover.
  
  Section 24 of the NDIS Act establishes the criteria for a person to meet disability requirements.
  
  Section 25 of the NDIS Act establishes the criteria for a person to meet the early intervention requirements.
validation code: |
  if date_difference(date_recieved_access_request, today()).days > 90:
    raise DAValidationError("It has been more than 90 days since the original access review decision, and without a approved extension for internal review, we cannot proceeed with review, you might need help with A new access request instead. If you had an extension, please kindly set that as the date above instead.")
  if date_difference(date_recieved_access_request, today()).days < 0 and confirm_date_internal_review_decision == 'Yes' :
    raise DAValidationError("Please kindly check your input date above correctly, You input indicates that you have received your access review decision in future.")
---

# Question block for external review details: internal review report
question: External Review Details
subquestion:  |
  What date did you receive your review decision?
fields:
  - What date did you receive the decision? : date_revieced_internal_review_report
    datatype: date
#    max: ${ today() }
    help: This date must be no more than 28 days from today.
    required: False
  - Is the date entered above the Original Review Decision Date?: confirm_date_revieced_internal_review_report
    help: 
      Yes indicates the above date as your Original Review Decision,
      No indicates above date is the last approved extension date you had been granted for external review application)
    datatype: radio
    choices:
      - Yes
      - No
  - What was the original date for Review Decision, if the date above is the maximum allowed external review application date from your approved extension request: original_date_revieced_internal_review_report
    datatype: date
    max: ${ today() }
    show if: 
      variable: confirm_date_revieced_internal_review_report
      is: No
  - What was the reason for rejection?: rejection_reason_internal_review
    input type: area
    required: False
  - Please upload a copy of your internal review report: copy_of_internal_review_report
    datatype: file
    accept: |
      "image/*, .pdf, application/pdf"
    required: False
    
validation code: |
  if date_difference(date_revieced_internal_review_report, today()).days > 28:
    raise DAValidationError("It has been more than 28 days since the review decision, and without an approved extension for external review, we cannot proceeed with review, you might need help with A new access request instead. If you had an extension, please kindly set that as the date above instead.")
  if date_difference(date_revieced_internal_review_report, today()).days < 0 and confirm_date_revieced_internal_review_report == 'Yes' :
    raise DAValidationError("Please kindly check your input date above correctly, You input indicates that you have received your access review decision in future.")
---
# Question block for external review details: application to AAT
question: External Review Details
subquestion:  |
  If you have made an application to the AAT for an external review, on what date did you do so?
fields:
  - Date: date_AAT_application 
    datatype: date
    max: ${ today() } 
    required: False
  - Please upload a copy of your application to the AAT: copy_of_application_AAT
    datatype: file
    accept: |
      "image/*, .pdf, application/pdf"
    required: False
---
question: Have you received any other documents from the AAT?
yesno: documents_uploaded
---
question: AAT Other Document Upload
subquestion:  |
  Please upload any additional documents you have received from the AAT (e.g. directions, listings, or statement of issues.)
  
  PDF and image files accepted 
  
fields:
  - Upload: AAT_documents
    datatype: files
    accept: |
      "image/*, .pdf, application/pdf"
    required: False
---
# Question block for file caption for additional AAT document upload
question: |
  What is the caption for this file?
subquestion: |
  ${ AAT_documents[i].filename }
fields:
  - Caption: AAT_documents[i].caption
    input type: area
    help: |
      This should be the title of the document you are uploading.
---