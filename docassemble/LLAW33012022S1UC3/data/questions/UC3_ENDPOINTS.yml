# The endpoints
---
# Objects block for setting DAList
objects:
  - documents: DAList.using(auto_gather=False)
---
# Code block that determines intial eligibility based on what user needs assistance with
# Uniting Communities only able to provide assistance with matters regarding NDIS access request or review of an NDIS access request
# Code block that sets conditions for inticial eligibity 
# Age needs to be between 18-65 and they must be a resident of South Australia
mandatory: True
code: |
  who_is_filing
  if NDIS_assistance == 'Yes':
    if applicant_age_ok and state_of_residence == 'South Australia':
      ATSI_background
      primary_disability
      how_did_you_hear
      phone_number
      currently_homeless
      centrelink_payment
      letter_of_consent
      if letter_of_consent != None:
        documents.append(letter_of_consent)
      if type_of_assistance == 'new_request':
        new_access_request
        if new_access_request != None:
          documents.append(new_access_request)
      elif type_of_assistance == 'internal_review':
        date_recieved_access_request
        if copy_of_internal_review_decision != None:
          documents.append(copy_of_internal_review_decision)
      elif type_of_assistance == 'external_review':
        date_recieved_access_request
        if copy_of_internal_review_decision != None:
          documents.append(copy_of_internal_review_decision)
        date_revieced_internal_review_report
        if copy_of_internal_review_report != None:
          documents.append(copy_of_internal_review_report)
        date_AAT_application
        if copy_of_application_AAT != None:
          documents.append(copy_of_application_AAT)
        if documents_uploaded:
          AAT_documents
        else:
          AAT_documents = []
      elif type_of_assistance == 'other':
        other_resources
      documents.gathered=True
      eligible
    else:
      ineligible
  else:
    other_resources
---
# This code block defines applicant_age_ok
code: |
  if 18 <= applicant.age_in_years() < 65:
    applicant_age_ok = True
  else:
    applicant_age_ok = False
---
# Endpoint 'other resources'
# User will be directed here if they are seeking assistance with a matter unrelated to an NDIS access request/review
event: other_resources
question: Other Resources
subquestion: |

  You have indicated that you are seeking aid with a matter unrelated to an NDIS access request or review of an NDIS access request. As such, Uniting Communities will not be able to provide you with assistance at this time. 
  
  Please find below a list of resources or other organisations that may be able to help you:
  
  ${ action_button_html("https://www.ndis.gov.au/applying-access-ndis", label="NDIS Access", color="primary", size="md") }

  ${ action_button_html("https://www.ndis.gov.au/applying-access-ndis/how-apply/receiving-your-access-decision", label="After getting your access decision", color="primary", size="md") }

  ${ action_button_html("https://www.ndis.gov.au/applying-access-ndis/how-apply/receiving-your-access-decision/internal-review-decision", label="Internal review decision", color="primary", size="md") }
  
  ${ action_button_html("https://www.aat.gov.au/apply-for-a-review/national-disability-insurance-scheme-ndis/how-to-apply", label="AAT application", color="primary", size="md") }
  
  ${ action_button_html("https://lsc.sa.gov.au/cb_pages/ndis.php", label="Legal Services commission NDIS Help", color="primary", size="md") }
  
  ${ action_button_html("https://lsc.sa.gov.au/resources/Application%20Form%20for%20NDIS%20Appeals%20Legal%20Services%20December%202019.pdf", label="LSC application for NDIS appeals", color="primary", size="md") }
  
  ${ action_button_html("https://www.ndiscommission.gov.au/about/complaints", label="NDIS Quality and Safeguards Commission Complaints", color="primary", size="md") }

  ${ action_button_html("https://www.ndis.gov.au/contact/locations/-35.0261%2C138.6373/100/11250", label="Find your Local Area Coordinator (LAC)", color="primary", size="md") }

  ${ action_button_html("https://www.sahealth.sa.gov.au/wps/wcm/connect/public+content/sa+health+internet/about+us/department+for+health+and+wellbeing/office+for+ageing+well/adult+safeguarding+unit/adult+safeguarding+unit", label="Adult Safeguarding Unit", color="primary", size="md") }

  ${ action_button_html("https://lsc.sa.gov.au/cb_pages/dila.php", label="Legal Services Commission disability information and legal assistance unit", color="primary", size="md") }

  ${ action_button_html("https://lsc.sa.gov.au/", label="Legal services commission", color="primary", size="md") }

  ${ action_button_html("https://www.afdo.org.au/resource-disability-advocacy-organisations/", label="Disability Advocacy Organisations", color="primary", size="md") }


  If you have any further questions, please contact Unitng Communities on **08 8202 5867** or email us at **das@unitingcommunities.org**.
buttons:
  - Restart: restart
  - Exit: exit
    url: https://www.unitingcommunities.org
---
# Endpoint 'ineligible'
# User will be directed here if they are not between 18-65 and if they live outside of South Australia
event: ineligible
question: You are not eligible
subquestion: |

  It would appear you are not eligible to receive assistance from Uniting Communities at this time. This is because 
  % if applicant.age_in_years() < 18 and state_of_residence == 'South Australia':
  you are under 18 years of age.
  % elif applicant.age_in_years() > 65 and state_of_residence == 'South Australia':
  you are over 65 and, as such, do not meet the age requirement set out under s22 of the National Disability Insurance Scheme Act 2013.
  %elif applicant.age_in_years() and state_of_residence != 'South Australia':
  you are not currently a resident of South Australia.
  % elif  applicant.age_in_years() < 18 and state_of_residence  != 'South Australia':
  you are under 18 years of age and are not currently a resident of South Australia. 
  % elif applicant.age_in_years() > 65 and state_of_residence != 'South Australia':
  you are over 65 and, as such, do not meet the age requirement set out under s22 of the National Disability Insurance Scheme Act 2013. In addition to this, you are not currently a resident of South Australia.
  % endif
  
  If you have any further questions, please contact Unitng Communities on **08 8202 5867** or email us at **das@unitingcommunities.org**.
buttons:
  - Restart: restart
  - Exit: exit
    url: https://www.unitingcommunities.org/service/disability/supportcoordination
---
# Endpoint 'eligible'
# User will be directed to this endpoint if they are seeking assistance with an NDIS access request/review, are between 18-65 and are a resident of SA
# This is where the final table of answers will be displayed and the list of documents uploaded and those still needing to be uploaded will be shown
# Where the information is emailed to the user and UC and where email sent status is displayed
event: eligible
question: Thank you for completing the Uniting Communities application for assistance
subquestion: |
  Based on your responses, Uniting Communities may be able to provide you with assistance in relation to your NDIS 
  % if type_of_assistance == 'new_access_request':
  new access request
  % elif type_of_assistance == 'internal_review':
  internal review
  % elif type_of_assistance == 'external review':
  external review
  % elif type_of_assistance == 'other':
  ${ type_of_assistance_other }
  % endif
  
  The following is a table of the information you have provided. Please read over it to confirm all the details are correct before clicking continue. 
  
  Question|Your Response
  --------|--------
  Do you need assistance with a matter relating to an NDIS access request or review of an NDIS access request?            | ${ NDIS_assistance }
  % if who_is_filing == 'Yes':
  Are you filling in this application on behalf of someone else?            | ${ who_is_filing }
  Do you have that person's consent?             | ${ applicant_concent }
  % endif
  Name    | ${ applicant_salutation } ${ applicant }
  Age                | ${ applicant.age_in_years() }
  Date of Birth  | ${ applicant.birthdate.format('d MMMM YYYY') }
  State of residence | ${ state_of_residence } 
  Are you of Aboriginal or Torres Straight Islander decent?   | ${ ATSI_background }
  County of birth   | ${ country_of_birth }
  Is English the primary language that you speak?   | ${ english_first_language }
  % if english_first_language == 'No':
  What is the primary language that you speak?   | ${ first_language }
  Do you require an interpretor?   | ${ interpretor_required }
  % endif
  What is your primary disability?   | ${ primary_disability }
  % if type_of_assistance == 'new_request':
  What sort of assistance do you need?   | New Access Request
  % elif type_of_assistance == 'internal_review':
  What sort of assistance do you need?   | An Internal Review (NDIA)
  % elif type_of_assistance == 'external_review':
  What sort of assistance do you need?   | An External Review (AAT)
  % elif type_of_assistance == 'Other':
  What other type of assistance do you seeking?   | ${ type_of_assistance_other }
  % endif
  Who referred you to Uniting Communities?   | ${ how_did_you_hear }
  Phone number   | ${ phone_number }
  Email   | ${ applicant.email }
  Are you currently homeless?   | ${ currently_homeless }
  % if currently_homeless == 'No':
  Are you at risk of becoming homeless?   | ${ at_risk_homeless }
  What is your address   | ${ address.block(show_country=False) }
  Is this also your postal address?   | ${ also_postal_address }
  % endif
  % if currently_homeless == 'No' and also_postal_address == 'No':
  What is your postal address?   | ${ postaddress.block(show_country=False) }
  % endif
  Are you currently receiving any Centrelink payments   | ${ centrelink_payment }
  % if type_of_assistance == 'internal_review':
  % if confirm_date_internal_review_decision == 'Yes':
  What date did you recieve your access request decision?   | ${ date_recieved_access_request.format('d MMMM YYYY') }
  % elif confirm_date_internal_review_decision == 'No':
  What is the maximum date extension allowed for your internal review request?   | ${ date_recieved_access_request.format('d MMMM YYYY') }
  What date did you recieve your original access request decision?   | ${ original_date_recieved_access_request.format('d MMMM YYYY') }
  % endif
  What date did you recieve funding for your plan?   | ${ date_recieved_funding.format('d MMMM YYYY') }
  What is the reason for rejection?   | ${ rejection_reason_access_request }
  % elif type_of_assistance == 'external_review':
  What date did you recieve your access request decision?   | ${ date_recieved_access_request.format('d MMMM YYYY') } }
  What date did you recieve funding for your plan?   | ${ date_recieved_funding.format('d MMMM YYYY') } }
  What is the reason for rejection?   | ${ rejection_reason_access_request }
  What date did you recieve an internal review report?   | ${ date_revieced_internal_review_report.format('d MMMM YYYY') } }
  What is the reason for rejection?   | ${ rejection_reason_internal_review }
  If you have made an application to the AAT for review, on whatd date did you do so?   | ${ date_AAT_application.format('d MMMM YYYY') } }
  
  ###List of documents uploaded###
  % for AAT_document in AAT_documents:
  
  ${ AAT_document.caption }
  
  % endfor
  % endif
  
  The above information will be e-mailed to you and Uniting Communities for them to review. Once they have done so, they should be contact with you within a week. If you do not hear back from them by then, or if you have any further questions, please contact Unitng Communities on **08 8202 5867** or email them at **das@unitingcommunities.org**.
  
  E-mail status:
  % if email_sent_ok:
  The e-mail was sent successfully.
  % else:
  There was a problem sending the e-mail.
  % endif
---
